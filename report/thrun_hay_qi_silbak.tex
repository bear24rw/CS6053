\documentclass[10pt]{article}

\usepackage{fancyhdr}
\usepackage[includeheadfoot,left=1in, right=1in, top=0.5in, bottom=0.5in]{geometry}
\usepackage{lastpage}
\usepackage{extramarks}
\usepackage[usenames,dvipsnames]{color}
\usepackage{graphicx}
\usepackage{graphics}
\usepackage{listings}
\usepackage{courier}
\usepackage{float}
\usepackage{url}
\usepackage{subfigure}
\usepackage{amsmath}
\usepackage{varwidth}
\usepackage{caption}
\usepackage{multirow}
\usepackage[pdfborder={0 0 0}]{hyperref}
\usepackage[compact,small]{titlesec}
\usepackage{microtype}
\usepackage{verbatim}
\usepackage{booktabs}
\usepackage{indentfirst}
\usepackage{pgffor}
\usepackage[table]{xcolor}

\rowcolors{2}{gray!25}{white}

\parskip = 0.5\baselineskip
\setlength{\belowcaptionskip}{-\baselineskip}

\captionsetup{font=scriptsize}
\captionsetup{labelfont=bf}

\pagestyle{fancy}
\rhead{Stack Attack}
\lhead{Network Security}
\rfoot{Page\ \thepage\ of \protect\pageref{LastPage}}
\cfoot{}
\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}

% make verbatim text small
\makeatletter
\g@addto@macro\@verbatim\tiny
\makeatother

\setlength\parindent{0pt} % Removes all indentation from paragraphs

\definecolor{sh_comment}{rgb}{0.12, 0.38, 0.18 } %adjusted, in Eclipse: {0.25, 0.42, 0.30 } = #3F6A4D
\definecolor{sh_keyword}{rgb}{0.37, 0.08, 0.25}  % #5F1441
\definecolor{sh_string}{rgb}{0.06, 0.10, 0.98} % #101AF9

\lstset{
    language=python,
    xleftmargin=.25in,
    xrightmargin=.25in,
    numbers=left,
    numberstyle=\tiny,
    frame=tb,
    showstringspaces=false,
    captionpos=b,
    stringstyle=\color{sh_string},
    keywordstyle = \color{sh_keyword}\bfseries,
    commentstyle=\color{sh_comment}\itshape,
    %basicstyle=\footnotesize\sffamily,
    basicstyle=\scriptsize\sffamily,
    %numbersep=-5pt,
    belowskip=\baselineskip,
    aboveskip=\baselineskip
}

\let\oldtabular\tabular
\renewcommand{\tabular}{\footnotesize\oldtabular}

\newcommand{\placementimage}[2]{
    \begin{figure}[H]
        \centering
        \includegraphics[width=\linewidth, height=4in, keepaspectratio]{#1}
        \caption{#2}
    \end{figure}
}

\newcommand{\specialcell}[2][c]{\textbf{\begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}}

\title{
    %Cover page with student’s name, title of the report, date submitted and the
    %statement “Submitted as the Capstone Project for the Master of Engineering
    %Degree”
    \vspace{2in}
    \textmd{\textbf{CS6053 - Network Security}}\\
    \vspace{4in}
}
\author{\textbf{Max Thrun | Josh Hay | Xiahui Qi | Samir Silbak}}

\begin{document}
\maketitle
\newpage
\parskip = 0.2\baselineskip
\newpage
\tableofcontents
%\newpage
\listoffigures
\listoftables
%\lstlistoflistings
\parskip = 0.5\baselineskip
\newpage

\section{Abstract}

\section{Introduction}

%\begin{figure}[H]
%    \centering
%    \includegraphics[width=\linewidth]{./pics/mitm_attack.jpg}
%    \caption{Man-In-The-Middle Attack}
%\end{figure}

\newpage
\section{Appendix}
    \subsection{Python Code}
    \newpage
    \newpage
    \lstinputlisting[caption=\textbf{Server}]{../server.py}
    \lstinputlisting[caption=\textbf{Client}]{../client.py}
    \lstinputlisting[caption=\textbf{Diffie Hellman}]{../diffie_hellman.py}
    \lstinputlisting[caption=\textbf{Karn}]{../karn.py}
    \lstinputlisting[caption=\textbf{Fiat-Shamir - Zero Knowledge Proof}]{../fiat.py}
    \lstinputlisting[caption=\textbf{Printer}]{../printer.py}
    \lstinputlisting[caption=\textbf{Base 32}]{../base32.py}
    \lstinputlisting[caption=\textbf{Configuration File}]{../config.py}
    \lstinputlisting[caption=\textbf{Test 1}]{../test.py}
    \lstinputlisting[caption=\textbf{Test 2}]{../test2.py}

\newpage
\begin{thebibliography}{9}
    \bibitem{ssl} \url{http://www.digicert.com/sha-2-ssl-certificates.htm}
\end{thebibliography}

\end{document}
